# GetFreeInCsuft

## :star: 前言

GetFreeInCsuft 项目致力于使广大 Csufter 能够较为舒服的使用校园网，当然既然起了这个名字，应该不限于校园网，任何能够白嫖的事情应该都可以。

笔者家贫，无从致网以用，每假借于有网之人，手脚并用，计分以还...... 咳咳，总之后来发现了 mentohust 这个项目，于是使用了 Openwrt + mentohust 在宿舍内用了两年路由器，后来想要在 windows 上使用，于是有了该项目，也算是对自己大学期间折腾网络的总结吧。

锐捷客户端更恶心的一个地方就是，对于计算机专业同学来说，开启虚拟机会造成多 IP 导致掉线，十分恶心，并且不能电脑开热点。

## :bookmark_tabs:项目说明

由于该 Mentohust 项目十分久远，源码已经找不到了，找到了一个魔改版本：[zzurj](https://github.com/2512500960/zzurj)，总之基于 802.1x 的认证包结构大致都差不多，所以基本上就是针对这个项目进行了部分魔改，更改了部分字段的偏移量，总之目前暂时能用了，隐藏 Bug 应该不会少，有问题请提 Issues 或 [QQ群：389616405](https://qm.qq.com/cgi-bin/qm/qr?k=Fn2dZQUkubDl_rA8E-Yv8kcut5fzGML2&jump_from=webapi&authKey=1Om2MmWG3CbOakrQf257j1eCX+WpRbQAYABGYfE3SB19bzlzc0S5hRpZCKcnJVrR)

## :pencil2: 项目使用

For Windows:

- 请直接在 Release 中下载最新版本

For Linux:

- Linux 可以使用 [minieap](https://github.com/updateing/minieap)，使用 Linux 作为主系统，相信你的能力是可以的，加油！

For Mac：

- I can't do it，似乎是有相关的项目的

### Windows

> 注意，需要接口正常的，使用该程序才能认证成功，该程序认证成功后可以正常开启热点功能等，对计算机专业同学来说，需要开启虚拟机，作用更大！（不用我多说了吧，多 IP 烦死人）

1. 下载好最新版本的应用程序，并设置以管理员方式运行。

   ① 右键 **认证助手.exe**，② 点击 **兼容性**，③ 选择 **以管理员身份运行此程序**，④ 点击 **应用**

2. 若打开助手提示找不到 `mfc140ud.dll`、`VCRUNTIME.dll`、`ucrtbased.dll`、`wpcap.dll` 等文件，则是缺少微软运行库，一般表现在新安装的纯净系统上（缺少很多运行库，需要手动安装），若遇到此提示，请确认操作系统位数，然将项目中的 `back/dll/` 的文件

   - 32 位操作系统：将 `win32` 文件夹下所有文件移动至 `C:\\Windows\\System32` 文件夹内
   - 64 位操作系统：将 `win64` 文件夹下所有文件移动至 `C:\\Windows\\SysWOW64` 文件夹内

   或 **以管理员方式运行** **Dll安装&卸载.bat** 批处理脚本即可。

3. 若打开助手提示找不到网卡，或网卡列表为空，请退出程序，并双击 **WinPcap_4_1_3.exe**，安装此程序，全部默认安装。

4. 双击打开认证助手，并设置账号密码

   ![image-20230221164548408](assets/image-20230221164548408.png)

5. 选择网卡

   **默认选择的网卡一定不是有线网卡！！！**

   网卡列表中包含以下字符的一定不是有线网卡，具体自己有线网卡是哪个请自行确定：

   - `Microsoft`
   - `Wireless`
   - `AX`
   - `AC`
   - `Adapter`
   - `Hyper-V`
   - `Virtual`
   - `Wan`

6. 点击认证上网即可，有时会发包失败，再试一次即可， 一般认证上之后就不会掉线了

7. 设置开启自动启动以及自动认证

   ![image-20230221164750301](assets/image-20230221164750301.png)

8. 若开启电脑热点提示无法开启，请尝试重启电脑即可。

## 其他

> 其实教程满天飞，我们生在信息爆炸的时代，虽然获取信息的途径多种多样，但信息差却一直是人与人之间很大的差距。

### 路由器共享有线网

#### 1. 故事的起源—极路由3

怎么获取到可以共享校园网这条信息，却是三年前的事情了，确实记不得了，只记得当时在咸鱼几十块钱购入了 **极路由3** 然后插件市场内附带的有锐捷认证，当时甚至都不知道它用的其实也是 mentohust 这个项目。

当自己成功共享的那一刻，快乐？开心？等等心情，难以表达，总之是感觉很酷的一件事情。后来也是通过这个信息差帮助别人搞了一下，当然，我也不知道自己图什么，**分逼没赚！**

至于配置界面，好像什么都不用改，就填一下自己的校园网账号密码就行了，当然对于移动有线网用户，可能会提示用户 MAC 地址绑定错误的认证失败消息，这是因为移动的认证是绑定 MAC地址的（所以借别人账号用时也会出现这个报错），MAC 地址是与网卡绑定的，所以路由器的 MAC 地址与你的电脑 MAC 地址不一致，就会出现这个报错了，解决方式也很简单，复制一下 MAC 地址就行了，管理界面都有的。

或者可以通过校园网内网环境访问：[http://rj.csuft.edu.cn:8080/selfservice/](http://rj.csuft.edu.cn:8080/selfservice/)，账号密码就是校园网账号密码，登陆上去之后解绑 MAC 即可（七天一次，否则就要到电子楼一楼去改了）

#### 2. 发现新大陆—Breed

后来的我不满足于现状，也是因为当时电信有线网被信息中心强制接入学校管理，之前的电信有线网虽然网速不快，但是延迟是真的低，也不掉包，因为用的光纤，直接从校外拉进来的，假如和装光纤的师傅关系好甚至可以让他给你改成 200M 甚至更高（当然也要给钱）。

当时的我配合有线网接入测试，发现中间有个缓冲期（一个学期），采用 Web 认证的方式（即无线网的那个网页认证）来认证有线网，Web 认证简直简单到离谱，CURL POST 一个包就算认证成功了（当然账号密码少不了），然后定时 POST 一下就能实现不断网了（Android 不知道，IPHONE 似乎有个快捷指令可以这么做，设置好之后就可以连接无线网的时候不用自己去网页输入了）。提到定时任务，极路由3官方系统就满足不了我了。

于是在我的一番搜索下，了解到了 Padavan 以及 Openwrt 系统，谈到这两个系统就不得不谈到本篇最重要的一个工具：Breed，中文名不死鸟，故名思意可以保护我们的路由器不死，不会变成砖头，它提供了一个 Web UI 可以简单，方便的进行系统刷入。

当然，在刷入 Breed 的过程中，是不会保证路由器不死的，它的不死保证的是刷入之后的，所以，我的极路由3，光荣牺牲了，成为了一块砖头（因为我眼瞎选错了版本:cry:），至今还躺在我的保险柜当中。

总之，在我的一番折腾下，成功刷入了 Padavan，俗称 “老毛子” 系统，并且设置了定时任务，愉快的使用了一个学期的 80M 的有线网（此时只是配合接入，实际上走的还是电信光纤，网速还快了很多，美滴很）。

当然，敲重点，我的极路由3已经光荣了，所以我已经更换了下篇要将的 K2 路由器。

#### 3. 信息差赚钱—K2

在上篇发现可行之后，我便购入了一批 K2 路由器，然后配合着校园网+光猫+路由器一起售卖，主打的就是一个一条龙服务，刷入的路由器系统还是以 Padavan 为主，因为当时在给电信运营商打工（卖卡，卖校园网），所以主要还是帮忙推电信为主。

老毛子用来跑定时任务还是很方便的，也是被迫学习了一下 Shell 脚本（我才不会说我大二就开始没好好听课，Linux 课完全水过去的），它的格式还让我难受了好久，多个空格（变量赋值时等号两边不能加！！！）让我找了好久的 Bug（只能说自己半吊子，活该），sh 脚本至今应该还有备份，后续应该会上传至 back 文件夹下。

提到了空格，我又想到了写 bat 脚本的时候（Windows 下的批处理文件）也是因为 if 后面多了个空格，导致一直跑不出我想要的结果，找了半夜的 Bug（哭死了我 :sob:）

总之这算是我大学赚到的一桶金（不是第一桶金哦）？还不错欸，我不认为我拿这些开源的东西赚钱有什么的（有意见我也不听:hear_no_evil::hear_no_evil::hear_no_evil:），我赚的是信息差。

#### 4. 不安现状—K2P

一学期后，电信如约换成了锐捷认证，IP 也变成移动的 IP 地址了，至今为止（2023.2）一直是，说是如约，鬼知道开学那几天我天天睡三个小时帮忙处理认证报错有多苦逼，这钱:moneybag:是真难赚！

**人嘛，总是会安于现状，却又不满足于现状。** 于是就想是否可以带宽叠加，又是一番搜索下，我了解到了 Openwrt 系统可以做到，通过虚拟网卡，负载均衡来实现。

但是由于 K2 系统的 Wan 口是百兆的，即撑死就跑 100M，当时用两个账号能够稳定跑到 80M 左右，再叠加更多账号也不行了。一番研究下发现了以下几个要点：

1. 网线得是超5类或者6类网线，首先网线得支持千兆
2. 路由器 Wan 口得是千兆的，K2 是百兆路由，所以引入本片关键 ==》`K2P`
3. 宿舍墙上的有线网接口得是千兆的，笔者宿舍一个千兆一个百兆，当时也是没有发现这一点，满足了前两点还是一直拨号拨不上去

于是在我后来的努力下，成功使用五个账号拨号到了 200M，当然这时的我只是为了研究了，宿舍用这玩意儿多少有点奢侈了：`38 * 5 = 190` 一个月，还不算上路由器的费用，之所以是 38 一个月是因为电信中间有个学期推出过只带有有线网的校园网套餐，个人认为性价比很高，至今还在使用。

### 交叉编译 mentohust 及 Openwrt

> 所谓交叉编译，就是在非目标机器上为目标机器编译。

#### 可选方法：

1. 直接安装 Linux 系统（服务器、虚拟机、双系统等）
2. 使用 WSL（Windows Subsystem for Linux）

这两种方法在我陆续地折腾中，都使用过，个人认为第二种较为简单，只是编译过程耗费了我 5~6 个小时，且需要全程保证魔法环境。

待补充···

## 版本说明

### V1.1

- 第一次编译，仅针对电信认证进行抓包更改字段偏移量，未对移动、联通账号进行测试，不过按照推算应该是都一样的。

